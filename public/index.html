<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Complex Continued Fraction Convergent Visualizer</title>
  <link rel="icon" type="image/svg+xml" href="/images/icon.svg?v=2">
  <link rel="stylesheet" href="style.css">
  <link
    href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&family=Open+Sans:wght@400;600;700&display=swap"
    rel="stylesheet">
</head>

<body>
  <div class="container">
    <header>
      <h1>Complex Simple Continued Fractions for Trigonometric Computation</h1>
      <p class="subtitle">A novel method: Expressing e<sup>i/q</sup> as continued fractions with simple coefficient
        patterns for
        efficient trig function evaluation</p>
    </header>

    <div class="content">
      <div class="input-section">
        <h2>Generate Coefficients</h2>


        <div class="input-container-row">
          <div class="input-header" id="headerFormula">Calculate for e<sup>iθ</sup></div>
          
          <div class="input-wrapper">
            <div class="decimal-group">
              <label for="angleInput" class="inline-label">Angle:</label>
              <input type="number" id="angleInput" value="1.0" step="0.1" min="-10" max="10">
            </div>

            <div class="equals-sign">=</div>

            <div class="rational-pi-group">
              <div class="fraction-container">
                <div class="fraction">
                  <input type="number" id="numeratorInput" class="fraction-input" placeholder="n" value="1">
                  <div class="vinculum"></div>
                  <input type="number" id="denominatorInput" class="fraction-input" placeholder="d" value="1">
                </div>
                <div class="times-dot">·</div>
              </div>
              
              <div class="pi-select-container">
                <select id="piDropdown" class="pi-dropdown">
                  <option value="1">1 (radians)</option>
                  <option value="22/7">π ≈ 22/7</option>
                  <option value="333/106">π ≈ 333/106</option>
                  <option value="355/113">π ≈ 355/113</option>
                  <option value="103993/33102">π ≈ 103993/33102</option>
                  <option value="104348/33215">π ≈ 104348/33215</option>
                  <option value="208341/66317">π ≈ 208341/66317</option>
                  <option value="312689/99532">π ≈ 312689/99532</option>
                  <option value="833719/265381">π ≈ 833719/265381</option>
                  <option value="1146408/364913">π ≈ 1146408/364913</option>
                  <option value="4272943/1360120">π ≈ 4272943/1360120</option>
                  <option value="5419351/1725033">π ≈ 5419351/1725033</option>
                  <option value="80143857/25510582">π ≈ 80143857/25510582</option>
                  <option value="245850922/78256779">π ≈ 245850922/78256779</option>
                </select>
              </div>
            </div>
          </div>
        </div>

        <div class="controls">
          <button id="plotButton">Generate & Plot Convergents</button>
          <button id="generateCoefficients">Generate Random Angle</button>
        </div>

        <div class="coefficients-convergents-grid">
          <div class="grid-column index-column">
            <h3>i</h3>
            <div id="indicesList" class="compact-point-list"></div>
          </div>
          <div class="grid-column coefficients-column">
            <h3>Coefficients</h3>
            <div id="coefficientsList" class="compact-point-list"></div>
          </div>
          <div class="grid-column base-convergents-column">
            <h3>Base Convergents</h3>
            <div id="baseConvergentsList" class="compact-point-list"></div>
          </div>
          <div class="grid-column final-convergents-column">
            <h3>Final Convergents</h3>
            <div id="finalConvergentsList" class="compact-point-list"></div>
          </div>
        </div>

        <div class="iteration-metrics-summary" id="iterationMetricsSummary" style="display: none;">
          <h3>Iteration Summary</h3>
          <div class="metrics-row">
            <div class="metric-item">
              <span class="metric-label">Convergent Iterations (i):</span>
              <span class="metric-value" id="convergentIterationsValue">-</span>
              <span class="metric-description">Iterations to compute convergents until mathematical limit</span>
            </div>
            <div class="metric-item">
              <span class="metric-label">Exponentiation Iterations (j):</span>
              <span class="metric-value" id="exponentiationIterationsValue">-</span>
              <span class="metric-description">Binary exponentiation steps: ⌈log₂(n)⌉ where n is the numerator</span>
            </div>
            <div class="metric-item">
              <span class="metric-label">Total Iterations (i+j):</span>
              <span class="metric-value" id="totalIterationsValue">-</span>
              <span class="metric-description">Combined computational iterations</span>
            </div>
          </div>
        </div>
      </div>

      <div class="canvas-section">
        <h2>Complex Plane Visualization</h2>
        <div class="canvas-container" id="canvasContainer">
          <canvas id="complexCanvas"></canvas>
        </div>

        <div class="zoom-controls">
          <button id="resetView">Reset View</button>
          <button id="zoomToLast">Zoom to Last Convergent</button>
          <button id="zoomToReference">Zoom to Reference</button>
        </div>

        <div class="convergent-info">
          <div class="convergent-item">
            <div>Current Convergent:</div>
            <div id="currentConvergent">0</div>
          </div>
          <div class="convergent-item">
            <div>Total Convergents:</div>
            <div id="totalConvergents">0</div>
          </div>
          <div class="convergent-item">
            <div>Distance to Unit Circle:</div>
            <div id="distanceToUnitCircle">0</div>
          </div>
        </div>

        <!-- Trigonometric Comparison Section -->
        <div class="trig-comparison">
          <h3>Trigonometric Value Comparison</h3>
          <div class="comparison-grid">
            <!-- Cosine Comparison -->
            <div class="comparison-card cosine-card">
              <div class="comparison-header">
                <span class="trig-symbol">cos(θ)</span>
                <span class="trig-name">Cosine</span>
              </div>
              <div class="comparison-values">
                <div class="value-group">
                  <div class="value-label">Our Convergent</div>
                  <div id="convergentCos" class="value convergent-value">0</div>
                </div>
                <div class="value-group">
                  <div class="value-label">JavaScript Math</div>
                  <div id="jsCos" class="value js-value">0</div>
                </div>
                <div class="value-group difference-group">
                  <div class="value-label">Difference</div>
                  <div id="diffCos" class="value diff-value">0</div>
                </div>
              </div>
            </div>

            <!-- Sine Comparison -->
            <div class="comparison-card sine-card">
              <div class="comparison-header">
                <span class="trig-symbol">sin(θ)</span>
                <span class="trig-name">Sine</span>
              </div>
              <div class="comparison-values">
                <div class="value-group">
                  <div class="value-label">Our Convergent</div>
                  <div id="convergentSin" class="value convergent-value">0</div>
                </div>
                <div class="value-group">
                  <div class="value-label">JavaScript Math</div>
                  <div id="jsSin" class="value js-value">0</div>
                </div>
                <div class="value-group difference-group">
                  <div class="value-label">Difference</div>
                  <div id="diffSin" class="value diff-value">0</div>
                </div>
              </div>
            </div>

            <!-- Tangent Comparison -->
            <div class="comparison-card tangent-card">
              <div class="comparison-header">
                <span class="trig-symbol">tan(θ)</span>
                <span class="trig-name">Tangent</span>
              </div>
              <div class="comparison-values">
                <div class="value-group">
                  <div class="value-label">Our Convergent</div>
                  <div id="convergentTan" class="value convergent-value">0</div>
                </div>
                <div class="value-group">
                  <div class="value-label">JavaScript Math</div>
                  <div id="jsTan" class="value js-value">0</div>
                </div>
                <div class="value-group difference-group">
                  <div class="value-label">Difference</div>
                  <div id="diffTan" class="value diff-value">0</div>
                </div>
              </div>
            </div>
          </div>

          <!-- Convergence Indicator -->
          <div class="convergence-indicator">
            <div class="indicator-label">Convergence Quality:</div>
            <div class="indicator-bar">
              <div id="convergenceBar" class="indicator-fill"></div>
            </div>
            <div id="convergenceStatus" class="indicator-status">Not calculated</div>
          </div>
        </div>
      </div>

      <div class="instructions">
        <h2>How to Use This Visualizer</h2>
        <ul>
          <li><strong>Input Angle:</strong> Enter an angle in decimal radians or as a rational multiple of π</li>
          <li><strong>Select Approximation:</strong> Choose a π approximation from the dropdown (1 gives exact radians)</li>
          <li><strong>Generate Coefficients:</strong> The system generates coefficients for a complex simple continued fraction based on your angle's denominator</li>
          <li><strong>View Convergents:</strong> Each convergent (approximation) is calculated using the recurrence relation and shown in the grid</li>
          <li><strong>Visualize:</strong> The red circle represents the unit circle - convergents should approach it as more terms are computed</li>
          <li><strong>Final Result:</strong> The final convergent approximates e<sup>iθ</sup> where θ is your input angle</li>
        </ul>

        <h2>Canvas Controls & Visualization</h2>
        <ul>
          <li><strong>Pan:</strong> Drag the canvas with your mouse to move around the complex plane</li>
          <li><strong>Zoom:</strong> Use your mouse wheel to zoom in/out (preserves center point under cursor)</li>
          <li><strong>Focus Last:</strong> Click "Zoom to Last Convergent" to zoom to the final convergent</li>
          <li><strong>Focus Reference:</strong> Click "Zoom to Reference" to center on the exact e<sup>iθ</sup> point</li>
          <li><strong>Reset:</strong> Click "Reset View" to return to the default view</li>
          <li><strong>Hover Details:</strong> Hover over convergent points to see their exact complex values</li>
        </ul>

        <h2>Understanding the Results Grid</h2>
        <ul>
          <li><strong>Index (i):</strong> The iteration number, showing which step of the continued fraction this is</li>
          <li><strong>Coefficients:</strong> The complex coefficient a<sub>i</sub> in the continued fraction recurrence a<sub>0</sub> + 1/(a<sub>1</sub> + 1/(a<sub>2</sub> + ...))</li>
          <li><strong>Base Convergents:</strong> The rational approximations to e<sup>i/q</sup> (numerator/denominator of the continued fraction)</li>
          <li><strong>Final Convergents:</strong> Result of raising base convergents to the p-th power (where p/q is your angle), giving e<sup>ip/q</sup></li>
          <li><strong>Green Highlighted Row:</strong> Indicates the mathematical stopping point where the convergence criterion is met: |q<sub>n</sub>|<sup>4</sup> × |a<sub>n+1</sub>|<sup>2</sup> > |p|<sup>2</sup> × 2<sup>106</sup></li>
          <li><strong>Light Red Rows:</strong> Redundant convergents beyond the mathematical limit (these don't improve approximation and are excluded from visualization)</li>
        </ul>

        <h2>Trigonometric Comparison</h2>
        <ul>
          <li><strong>Our Convergent:</strong> The cos/sin/tan values derived from our continued fraction approximation</li>
          <li><strong>JavaScript Math:</strong> Reference values from JavaScript's native Math library</li>
          <li><strong>Difference:</strong> The absolute error between our approximation and the reference</li>
          <li><strong>Convergence Bar:</strong> Visual indicator of approximation quality (green = better)</li>
        </ul>

        <h2>Iteration Metrics</h2>
        <ul>
          <li><strong>Convergent Iterations (i):</strong> Number of steps required to compute convergents until the mathematical stopping criterion is met</li>
          <li><strong>Exponentiation Iterations (j):</strong> Binary exponentiation complexity: ⌈log₂(|p|)⌉ where p is the numerator (represents the bit-length of the exponent)</li>
          <li><strong>Total Iterations (i+j):</strong> Combined computational effort showing the total number of significant operations</li>
        </ul>

        <h2>Color Guide</h2>
        <ul>
          <li><strong>Light Blue Points:</strong> Valid convergents within the convergence domain</li>
          <li><strong>Green Border with Light Green Background:</strong> Mathematical limit point - this is the optimal stopping point for computation</li>
          <li><strong>Light Red Points:</strong> Redundant convergents beyond the mathematical limit (not plotted on canvas)</li>
        </ul>

        <h2>Tips for Exploration</h2>
        <ul>
          <li>Try small denominators (like π/2, π/3, π/4) to see fast convergence</li>
          <li>Compare different π approximations (22/7 vs 355/113) to see their accuracy differences</li>
          <li>Use "Generate Random Angle" to discover interesting patterns</li>
          <li>Zoom in to see how convergents spiral toward the unit circle</li>
          <li>Check the iteration metrics to understand computational efficiency</li>
        </ul>

        <h2>Mathematical Discovery</h2>
        <div class="discovery-note">
          <p><strong>Key Insights:</strong> This method provides unprecedented efficiency for computing trigonometric
            functions:</p>

          <div class="insights-grid">
            <div class="insight-card">
              <div class="insight-icon">1</div>
              <div class="insight-content">
                <h4>Simple Coefficient Patterns</h4>
                <p>For any integer q ≥ 1, e<sup>i/q</sup> has a complex simple continued fraction with predictable
                  coefficients as [re, im] tuple:</p>
                <ul>
                  <li>Index = 0: [1, 0]
                  <li>Index > 0:
                    <ul>
                      <li>Index odd: [0,-1<sup>(i+1)/2</sup>·i·q]
                      <li>Index even: [-1<sup>i/2</sup>·2,0]
                    </ul>
                </ul>
              </div>
            </div>

            <div class="insight-card">
              <div class="insight-icon">2</div>
              <div class="insight-content">
                <h4>Fast Convergence for Large n</h4>
                <p>As the denominator (q) grows, fewer coefficients are needed for accurate convergence:</p>
                <ul>
                  <li>For large q, often just 2-3 coefficients suffice</li>
                  <li>This enables efficient computation of trig functions for small angles</li>
                  <li>The method scales <em>better</em> with increasing precision needs</li>
                </ul>
              </div>
            </div>

            <div class="insight-card">
              <div class="insight-icon">3</div>
              <div class="insight-content">
                <h4>Efficient Exponentiation</h4>
                <p>Obtaining e<sup>ip/q</sup> uses binary exponentiation by p:</p>
                <ul>
                  <li>Powering complexity: O(log p) for exponent p</li>
                  <li>Maximum practical exponent computed in ≤ 24 steps</li>
                  <li>Normaly large p comes with large q thus self balancing increased cost of exponentiation by decreasing cost of convergent calculation</li>
                  <li>Typically requires fewer operations than direct methods</li>
                </ul>
              </div>
            </div>

            <div class="insight-card">
              <div class="insight-icon">4</div>
              <div class="insight-content">
                <h4>Simultaneous Trig Values</h4>
                <p>The convergent provides all trigonometric values at once:</p>
                <ul>
                  <li>Real part = cos(θ)</li>
                  <li>Imaginary part = sin(θ)</li>
                  <li>Tangent = sin(θ)/cos(θ)</li>
                  <li>All computed with the same efficiency</li>
                </ul>
              </div>
            </div>
          </div>

          <div class="efficiency-summary">
            <h4>Computational Efficiency Summary:</h4>
            <div class="efficiency-metrics">
              <div class="metric">
                <div class="metric-value">O(log m)</div>
                <div class="metric-label">Exponentiation Complexity</div>
              </div>
              <div class="metric">
                <div class="metric-value">≤ 23</div>
                <div class="metric-label">Max Exponentiation Steps</div>
              </div>
              <div class="metric">
                <div class="metric-value">2-3</div>
                <div class="metric-label">Typical Coefficients Needed</div>
              </div>
              <div class="metric">
                <div class="metric-value">All</div>
                <div class="metric-label">Trig Functions Simultaneously</div>
              </div>
            </div>
          </div>
        </div>
        <h2>How It Works</h2>
        <ul>
          <li>Enter an angle in decimal radians or as a rational multiple of π</li>
          <li>Select a π approximation from the dropdown (1 gives exact radians)</li>
          <li>The system generates coefficients for a complex simple continued fraction</li>
          <li>Each convergent (approximation) is calculated step by step and plotted</li>
          <li>The red circle is the unit circle - convergents should approach it</li>
          <li>The final convergent approximates e<sup>iθ</sup> where θ is the input angle</li>
          <li>Drag the canvas with your mouse to pan the view</li>
          <li>Use mouse wheel to zoom in/out</li>
          <li>Click "Zoom to Last Convergent" to focus on the final convergents</li>
          <li>Click "Generate Random Angle" for a random example</li>
        </ul>
      </div>

      <footer style="text-align: center; padding: 20px; color: #666; font-size: 0.9em;">
        <p>Trig Analyse: <span id="description"></span> &copy <span id="current-year"></span> <span id="author"></span> Version: <span id="app-version">v1.0.0</span></p>
        <script>
          // Optionally fetch version dynamically
          fetch('/api/version')
            .then(r => r.json())
            .then(data => {
              document.getElementById('description').textContent = data.description || 'Complex Continued Fraction Visualizer';
              document.getElementById('current-year').textContent = new Date().getFullYear();
              document.getElementById('author').textContent = data.author || 'Ömer Kaşdarma';
              document.getElementById('app-version').textContent = `v${data.version}`;
            })
            .catch(() => { }); // Fail silently
        </script>
      </footer>
    </div>

    <!-- JavaScript Modules -->
    <script type="module" src="main.js"></script>
</body>

</html>
